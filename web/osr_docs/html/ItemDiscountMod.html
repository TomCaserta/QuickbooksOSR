<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html>
<head>
  <link rel="stylesheet" href="styleguide.css" type="text/css" />
  <title>ItemDiscountMod.html</title>
</head>
<body>
<b><i>ItemDiscountMod</i></b><br />
Modifies a discount item. Starting with qbXML spec 7.0, you can modify the account ref, using the AccountRef aggregate and the  ApplyAccountRefToExistingTxns boolean.  You need to use the ApplyAccountRefToExistingTxns boolean because the QuickBooks UI displays a prompt asking whether the change should apply to existing transactions or not.  Specifying True for the boolean basically dismisses this with a "Yes" answer, allowing your changes to be made and changes any existing transactions that use the item with that AccountRef.  Specifying "False" means that the mod will not take affect if there are existing transactions.<br />
<br />
 
 Setting this to "True" should be used with caution and normally only after some user has indicated that they want those changes made to all those existing transactions!<br />
<br  />
 
 If any affected transactions are protected by a closing date and password, the AccountRef changes will not be made and so the Mod request will return an error without making the requested Mod. <br />
<br />
<b>Be Sharp When Using Flat Discounts </b> <br />
Flat rate discounts are treated VERY differently vs. percentage discounts. A percentage discount only applies to the line right above it, so all of the tax implications for discounts apply ONLY to that line (Note that the story gets more complicated here for group items, subtotal lines, etc). A flat rate discount applies to EVERY line that is recorded above the discount. Thus, the $10.00 off you see is applied equally to the $100.00 Nontaxable target and the $100.00 Taxable target. Thus, the sales tax for the 10.00 discount totals up to -$5.00. <br />
<br />
Therefore, for the desired behavior, the user must fill out the invoice like this: <br />

Item $100.00 Non <br />
Item $100.00 Tax <br />
Discount $20.00 Tax  <br />
<br />
In this scenario, the $20.00 discount is properly distributed to be half taxed and half not taxed, so the taxable amount for the discount line is only -$10.00. <br />
<br />

The moral of the story: <i>Non-Taxable Discounts are VERY dangerous</i>. You should almost never use them unless discounts in your state are never applied to sales tax.


</body>
</html>
